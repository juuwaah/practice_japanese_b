{% extends "base.html" %}

{% block title %}Admin Dashboard - Japanese Learning App{% endblock %}

{% block window_title %}ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}

{% block content %}
<div style="text-align: center; margin-bottom: 16px;">
  <h1>ğŸ“Š ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
</div>

<!-- çµ±è¨ˆæƒ…å ± -->
<div style="border: 2px solid #000; padding: 12px; margin-bottom: 16px; background: #FFFFFF;">
  <div style="font-size: 12px; font-weight: bold; margin-bottom: 8px;">çµ±è¨ˆæƒ…å ±</div>
  
  <div style="display: flex; justify-content: space-around; margin: 8px 0;">
    <div style="text-align: center;">
      <div style="font-size: 18px; font-weight: bold; color: #008080;">{{ total_users }}</div>
      <div style="font-size: 9px;">ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 18px; font-weight: bold; color: #800080;">{{ unread_feedback }}</div>
      <div style="font-size: 9px;">æœªèª­ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>
    </div>
    <div style="text-align: center;">
      <div style="font-size: 18px; font-weight: bold; color: #008000;">{{ recent_users }}</div>
      <div style="font-size: 9px;">éå»7æ—¥é–“ã®æ–°è¦ç™»éŒ²</div>
    </div>
  </div>
</div>

<!-- ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
<div style="border: 2px solid #000; padding: 12px; margin-bottom: 16px; background: #F0F0F0;">
  <div style="font-size: 12px; font-weight: bold; margin-bottom: 8px;">ç®¡ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼</div>
  
  <div style="display: flex; gap: 8px; flex-wrap: wrap;">
    <a href="{{ url_for('admin_feedback') }}" 
       style="background: #FFFFFF; border: 1px solid #000; padding: 6px 12px; text-decoration: none; 
              color: #000; font-size: 9px; font-weight: bold; display: inline-block;">
      ğŸ“ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç®¡ç† ({{ total_feedback }})
    </a>
    <a href="{{ url_for('admin_users') }}" 
       style="background: #FFFFFF; border: 1px solid #000; padding: 6px 12px; text-decoration: none; 
              color: #000; font-size: 9px; font-weight: bold; display: inline-block;">
      ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
    </a>
  </div>
</div>

<!-- æœ€è¿‘ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ -->
<div style="border: 2px solid #000; padding: 12px; margin-bottom: 16px; background: #FFFFFF;">
  <div style="font-size: 12px; font-weight: bold; margin-bottom: 8px;">æœ€è¿‘ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>
  
  {% if recent_feedback %}
    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse; font-size: 8px;">
        <thead>
          <tr style="background: #E0E0E0;">
            <th style="border: 1px solid #888; padding: 4px;">æ—¥æ™‚</th>
            <th style="border: 1px solid #888; padding: 4px;">åå‰</th>
            <th style="border: 1px solid #888; padding: 4px;">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</th>
            <th style="border: 1px solid #888; padding: 4px;">çŠ¶æ…‹</th>
          </tr>
        </thead>
        <tbody>
          {% for feedback in recent_feedback %}
          <tr>
            <td style="border: 1px solid #888; padding: 4px;">
              {{ feedback.created_at.strftime('%m/%d %H:%M') }}
            </td>
            <td style="border: 1px solid #888; padding: 4px;">{{ feedback.name }}</td>
            <td style="border: 1px solid #888; padding: 4px;">
              {{ feedback.message[:50] }}{% if feedback.message|length > 50 %}...{% endif %}
            </td>
            <td style="border: 1px solid #888; padding: 4px;">
              <span style="color: {% if feedback.status == 'unread' %}#FF0000{% else %}#008000{% endif %};">
                {% if feedback.status == 'unread' %}æœªå¯¾å¿œ{% else %}å¯¾å¿œæ¸ˆã¿{% endif %}
              </span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    
    <div style="text-align: center; margin-top: 8px;">
      <a href="{{ url_for('admin_feedback') }}" 
         style="font-size: 9px; text-decoration: underline; color: #000;">
        ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¦‹ã‚‹ â†’
      </a>
    </div>
  {% else %}
    <div style="text-align: center; color: #808080; font-size: 9px;">
      ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“
    </div>
  {% endif %}
</div>

<div style="text-align: center; margin-top: 20px;">
  <a href="{{ url_for('logout') }}" 
     style="background: #D0D0D0; border: 1px solid #000; padding: 8px 16px; text-decoration: none; 
            color: #000; font-size: 9px; font-weight: bold;">
    ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
  </a>
</div>
{% endblock %}